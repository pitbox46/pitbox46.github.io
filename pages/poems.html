<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <base href = "../">
		
		<title id="web_titleID">Poems</title>
		
		<link rel="stylesheet" href="assets/styles/main.css">
    </head>
    <body>
        <!-- Header to be filled in via javascript -->
        <div class="header" id="headerID"></div>

        <div class="post">
            <ul style="list-style-type: none;" id="poem_listID">
            </ul>
        </div>

        <script type="text/javascript" src="assets/js/header.js"></script>
        <script>
            var directoryPath = "https://raw.githubusercontent.com/pitbox46/pitbox46.github.io/main/posts/poems/";

            window.onload = function() {
                loadPoemList();
                loadHeaders();
            }

            function loadPoemList() {
                fetch(directoryPath + "directory.json", {cache:"no-cache"})
                    .then(response => response.json())
                    .then(json => {
                        console.log(json)
                        json.forEach(poemNum => {
                            fetch(directoryPath + poemNum + ".json")
                                .then(response => response.json())
                                .then(json => {
                                    TITLE = json.title;
                                    DATE = new Date(json.date).toLocaleDateString('default', {
                                        month:'long',
                                        day:'numeric',
                                        year:"numeric",
                                        timeZone:"UTC"
                                    });
                                    var list = document.getElementById("poem_listID");
                                    var anchor = document.createElement("a");
                                    var italic = document.createElement("i");
                                    italic.innerHTML = DATE;
                                    anchor.setAttribute("href", "posts/poem.html?number="+poemNum);
                                    anchor.innerHTML = TITLE + " - ";
                                    anchor.appendChild(italic);
                                    var element = document.createElement("li");
                                    element.innerHTML = poemNum + " - ";
                                    element.appendChild(anchor);
                                    list.appendChild(element);
                                });
                        });
                    });
            }
        </script>
    </body>
</html>